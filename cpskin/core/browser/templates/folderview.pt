<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="cpskin">

  <metal:styleslot fill-slot="style_slot" >
        <style>
        .section-notheme #portal-breadcrumbs {
            display: none;
        }
        </style>
  </metal:styleslot>

  <metal:javascript_head_slot fill-slot="javascript_head_slot"
                              tal:condition="view/hasFlexSlider">
      <script type="text/javascript"
              charset="utf-8"
              src=""
              tal:attributes="src string:${context/@@plone_portal_state/portal_url}/++resource++jquery.flexslider/javascript/jquery.flexslider-min.js"></script>
      <script type="text/javascript"
              charset="utf-8"
              src=""
              tal:attributes="src string:${context/@@plone_portal_state/portal_url}/++resource++jquery.flexslider/javascript/cpskin.slider.js"></script>
  </metal:javascript_head_slot>

  <body>
    <div metal:fill-slot="main"
         tal:define="member context/@@plone_portal_state/member;
                     contents view/getContents">
      <metal:main-macro define-macro="main">
        <div id="accueil">
            <tal:bcl tal:repeat="content contents">
              <tal:def tal:define="use_new_template python: view.use_new_template(content);
                                   use_slider python: view.use_slider(content);
                                   bloc_class python: view.get_block_class(content)">

                <div id="flex"
                     tal:condition="python: use_slider and view.hasFlexSlider() and view.is_browser_compatible()"
                     tal:attributes="class string:bloc-${repeat/content/number} bloc-collection-slider ${content/id} ${bloc_class}">

                    <div class="flex-container"
                         tal:define="context nocall:content;
                                     here nocall:content">
                        <tal:cond condition="python:view.getSliderType() == 'slider_view_vertical'">
                              <metal:block use-macro="context/@@slider_view_vertical/macros/content-core" />
                        </tal:cond>
                        <tal:cond condition="python:view.getSliderType() != 'slider_view_vertical'">
                              <metal:block use-macro="context/@@slider_view/macros/content-core" />
                        </tal:cond>
                    </div>

                </div>
                <div id="no-flex"
                     tal:condition="python: use_slider and not view.is_browser_compatible()"
                     tal:attributes="class string:bloc-${repeat/content/number} bloc-collection-slider ${content/id} ${bloc_class}">

                    <tal:if tal:condition="use_new_template">
                        <metal:use use-macro="context/@@cpskincore-macros/homepage-collection-new-template" />
                    </tal:if>
                    <tal:else tal:condition="not: use_new_template">
                        <metal:use use-macro="context/@@cpskincore-macros/homepage-collection" />
                    </tal:else>

                </div>

                <div class=""
                     tal:condition="python: not use_slider and content.portal_type == 'Collection' and content.results()"
                     tal:attributes="class string:bloc-${repeat/content/number} bloc-collection ${content/id} ${bloc_class}">

                    <tal:if tal:condition="use_new_template">
                        <metal:use use-macro="context/@@cpskincore-macros/homepage-collection-new-template" />
                    </tal:if>
                    <tal:else tal:condition="not: use_new_template">
                        <metal:use use-macro="context/@@cpskincore-macros/homepage-collection" />
                    </tal:else>

                </div>

                <div class=""
                     tal:condition="python: content.portal_type == 'Document'"
                     tal:attributes="class string:bloc-${repeat/content/number} bloc-document ${content/id} ${bloc_class}">

                    <p tal:condition="python: member.has_permission('Modify portal content', content)">
                      <a href=""
                         tal:attributes="href string:${content/absolute_url}/edit"
                         i18n:translate="modifier_zone_statique">[Modifier la zone statique]</a>
                    </p>
                    <p tal:replace="structure content/getText" />

                </div>

              </tal:def>
            </tal:bcl>

            <div class="visualClear"></div>

        </div>
      </metal:main-macro>
    </div>
  </body>
</html>

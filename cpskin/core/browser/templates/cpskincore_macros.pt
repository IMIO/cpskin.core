<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    i18n:domain="cpskin">

<body>

    <metal:homepage-collection define-macro="homepage-collection">

        <div class="titre-rss">
            <a href=""
                class="titre"
                tal:attributes="href string:${content/absolute_url}">
                <h2 tal:content="content/Title"></h2>
            </a>
            <a class="bloc-rss"
                href=""
                tal:attributes="href content/@@syndication-util/rss_url">
                <img src="++resource++cpskin.core.images/rss.png"
                     alt="Flux RSS"
                     i18n:attributes="alt flux_rss" />
             </a>
        </div>

        <div class="results"
            tal:define="allresults python: view.getResults(content);
                        resultTypes python: ['sticky-results', 'standard-results']"
            tal:condition="allresults">

            <tal:bcl tal:repeat="resultType resultTypes">
                <ul class=""
                    tal:define="results python: allresults[resultType]"
                    tal:condition="results"
                    tal:attributes="class string: ${resultType}">

                  <tal:bcl tal:repeat="result results">

                    <li tal:define="number repeat/result/number;
                                    isBigImage python: view.isBigImage(number, allresults, resultType);
                                    obj python: result.getObject()"
                        class=""
                        tal:attributes="class python: isBigImage and 'bigimage bloc-item' or 'bloc-item'">
                        <tal:block tal:condition="python: view.see_categories(content)">
                        <tal:loop tal:define="categories python: view.get_categories(content, obj)" tal:condition="categories">
                                <div class="indexview-categories" tal:content="categories" />
                        </tal:loop>
                        </tal:block>
                        <a href=""
                           tal:attributes="href result/getURL">
                               <tal:block tal:condition="not: view/is_dexterity">

                                <img class=""
                                   tal:define="oddRow repeat/result/odd;
                                               imageClass python: oddRow and 'myimageleft' or 'myimageleft';
                                               thumbsize python: view.getThumbSize(result, isBigImage)"
                                   src="#"
                                   alt=""
                                   tal:attributes="title result/Description;
                                                   src python: result.getURL() + '/' + thumbsize" />
                                </tal:block>
                                <tal:block tal:condition="view/is_dexterity">
                                <div class="homepageleadImage"
                                     tal:define="scaled_image python:view.collection_image_scale(content, obj)">

                                  <figure class="newsImageContainer" tal:condition="python: scaled_image">
                                      <img tal:replace="structure python: scaled_image" />
                                      <figcaption tal:condition="context/image_caption|nothing"
                                          tal:content="structure context/image_caption">
                                      </figcaption>
                                  </figure>

                                </div>
                                </tal:block>

                              <h3 tal:content="result/Title"></h3>
                            </a>

                            <span class="documentByLine"
                                  tal:condition="python: result.portal_type == 'Event'">
                              <tal:one_day condition="python: view.is_one_day(result)">
                              <span i18n:translate="evenement_le">le</span>
                              <span tal:content="python: view.toLocalizedTime(result.start, long_format=0, event=result)" />
                                <tal:withHours condition="python: view.is_with_hours(result)">
                                  <tal:openEnd condition="python: view.is_open_end(result)">
                                    <span i18n:translate="evenement_a_lheure">à</span>
                                    <span tal:content="python: view.toLocalizedTime(result.start, long_format=1, event=result)[11:]" />
                                  </tal:openEnd>
                                  <tal:fixedEnd condition="python: not view.is_open_end(result)">
                                    <span i18n:translate="evenement_de">de</span>
                                    <span tal:content="python: view.toLocalizedTime(result.start, long_format=1, event=result)[11:]" />
                                    <span i18n:translate="evenement_a">à</span>
                                    <span tal:content="python: view.toLocalizedTime(result.end, long_format=1, event=result, startend='end')[11:]" />
                                  </tal:fixedEnd>
                                </tal:withHours>
                              </tal:one_day>
                              <tal:more_days condition="python: not view.is_one_day(result)">
                                <span i18n:translate="evenement_du">du</span>
                                <span tal:content="python: view.toLocalizedTime(result.start, long_format=0, event=result)" />
                                <span i18n:translate="evenement_au">au</span>
                                <span tal:content="python: view.toLocalizedTime(result.end, long_format=0, event=result, startend='end')" />
                              </tal:more_days>
                            </span>

                            <span class="documentByLine"
                                  tal:condition="python: result.portal_type != 'Event' and view.hasEffectiveDate(result)">
                              <span tal:content="python: view.toLocalizedTime(result.effective, long_format=0)" />
                            </span>

                          </li>
                         </tal:bcl>
                        </ul>
                      </tal:bcl>
                    </div>
                    <a href=""
                       class="voir-tout"
                       tal:attributes="href string:${content/absolute_url}">
                       <span tal:replace='python: view.see_all(content)' />
                   </a>

    </metal:homepage-collection>

</body>
</html>
